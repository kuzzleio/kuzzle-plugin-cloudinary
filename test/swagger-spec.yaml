openapi: 3.0.1
info:
  title: 'Kuzzle plugin : Cloudinary'
  description: "This is an usage example of Kuzzle plugin 'Cloudinary'. You can find more about this plugin 
    on [GitHub](https://github.com/kuzzleio/kuzzle-plugin-cloudinary). If you need help, you can reach us on [Gitter](https://gitter.im/kuzzleio/kuzzle)"
  contact:
    email: support@kuzzle.io
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
externalDocs:
  description: Cloudinary-plugin repository 
  url: https://github.com/kuzzleio/kuzzle-plugin-cloudinary
servers:
- url: http://localhost:7512/_plugin/cloudinary
tags:
- name: assets
  description: Everything about your Cloudinary assets
- name: tags
  description: Manage the tags of your Cloudinary assets
paths:
  ## Assets controller
  /assets/{expression}:
    get:
      tags:
      - assets
      summary: Search for assets corresponging to the expression
      description: Multiple status values can be provided with comma separated strings
      operationId: searchAssets
      parameters:
      - name: expression
        in: path
        description: Expression that represents your research 
        required: true
        style: simple
        explode: true
        schema:
          type: string
      responses:
        200:
          description: successful operation
          
  /assets/transform:
    post:
      tags:
      - assets
      summary: Return an url of a transformed assets
      description: You can transform your assets with on-the-fly transformations.
      externalDocs: 
        url: https://cloudinary.com/documentation/image_transformation_reference
        description: More information about transformation request body object
      operationId: assetsTransformation
      requestBody:
        required: true
        content: 
          application/json:
            schema:
              type: object
              required: 
                - public_id
                - transformation
              properties: 
                public_id: 
                  type: string
                transformation: 
                  type: object 
            example: 
              public_id: "sample"
              transformation:
                width: 400
                radius: 0:100:100:100
      responses:
        200:
          description: successful operation
          content:
            text/plain:
              schema:
                type: string
                example: "https://res.cloudinary.com/demo/image/upload/w_400,r_0:100:100:100/sample.jpg"
              
        400:
          description: Bad Request error if one attributes is missing
          content: {}
          
  /assets: 
    put: 
      tags:
      - assets
      summary: Rename an asset
      operationId: renameAsset
      requestBody:
        required: true
        content: 
          application/json: 
            schema:
                type: object
                properties: 
                  from_public_id:  
                    type: string
                    example: "old_name"
                  to_public_id: 
                    type: string
                    example: "new_name"

      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        400:
          description: Bad Request error if one attributes is missing
          content: {}
        404:
          description: Asset not found
          content: {}
    delete: 
      tags:
      - assets
      summary: Delete an asset
      operationId: destroyAsset
      requestBody:
        required: true
        content: 
          application/json: 
            schema:
                type: object
                properties: 
                  public_id:  
                    type: string
                    example: "sample"
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        400:
          description: Bad Request error if one attributes is missing
          content: {}
        404:
          description: Asset not found
          content: {}
            
  ##Tags controller
  /tags:
    post:
      tags:
      - tags
      summary: Add new tag to one or several assets
      description: You can provide several assets in an array of string in the Request Body 
      operationId: addTags
      requestBody:
        description: public_id can be a String or an Array of String
        required: true
        content: 
          application/json: 
            schema:
                $ref: '#/components/schemas/TagRequestBody'
            example: 
                value : 
                  public_id: "sample"
                  tag: "a tag"
            
      responses:
        200:
          description: OK (returns all updated public_id)
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        206:
          description: If you entered several public_id, a 206 error might be thrown if one or several assets haven't been updated.
          content: 
            application/json:
              schema: 
                $ref : '#/components/schemas/PartialError'
    put: 
      tags:
      - tags
      summary: Replace all the tag from one or several assets with another tag
      description: You can provide several assets in an array of string in the Request Body 
      operationId: replaceTags
      requestBody:
        description: public_id can be a String or an Array of String
        required: true
        content: 
          application/json: 
            schema:
                $ref: '#/components/schemas/TagRequestBody'
            example: 
                value : 
                  public_id: "sample"
                  tag: "a tag to rule them all"
            
      responses:
        200:
          description: OK (returns all updated public_id)
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        206:
          description: If you entered several public_id, a 206 error might be thrown if one or several assets haven't been updated.
          content: 
            application/json:
              schema: 
                $ref : '#/components/schemas/PartialError'
    delete: 
      tags:
      - tags
      summary: Delete the tag from one or several assets
      description: You can provide several assets in an array of string in the Request Body 
      operationId: removeTag
      requestBody:
        description: public_id can be a String or an Array of String
        required: true
        content: 
          application/json: 
            schema:
                $ref: '#/components/schemas/TagRequestBody'
            example: 
                value : 
                  public_id: "sample"
                  tag: "the tag is a lie"
            
      responses:
        200:
          description: OK (returns all updated public_id)
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        206:
          description: If you entered several public_id, a 206 error might be thrown if one or several assets haven't been updated.
          content: 
            application/json:
              schema: 
                $ref : '#/components/schemas/PartialError'
                
  /tags/remove_all:
    delete: 
      tags:
      - tags
      summary: Delete all the tags from one or several assets
      description: You can provide several assets in an array of string in the Request Body 
      operationId: removeAllTags
      requestBody:
        description: public_id can be a String or an Array of String
        required: true
        content: 
          application/json: 
            schema:
              type: object
              required: 
                - public_id
                - tag
              properties: 
                public_id: 
                  oneOf: 
                    - type: array
                      items: 
                        type: string
                    - type: string 
            example: 
                value : 
                  public_id: "sample"
      responses:
        200:
          description: OK (returns all updated public_id)
          content:
            application/json:
              schema:
                type: string
                example: "sample"
        206:
          description: If you entered several public_id, a 206 error might be thrown if one or several assets haven't been updated.
          content: 
            application/json:
              schema: 
                $ref : '#/components/schemas/PartialError'               
components:
  schemas:
    TagRequestBody: 
      type: object
      required: 
        - public_id
        - tag
      properties: 
        public_id: 
          oneOf: 
            - type: array
              items: 
                type: string
            - type: string 
        tag: 
          type: string
    PartialError: 
      type: array
      items: 
        type: object
        properties: 
          message:
            type: string
          public_id: 
            type: string